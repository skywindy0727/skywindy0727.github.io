<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ¾³é–€å…­äººè¡Œ â€¢ 2025</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Zen+Old+Mincho:wght@400;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <style>
        /* --- ç°¡ç´„å’Œå¼ä¸»é¡Œ (Japanese Minimalist) --- */
        :root {
            --jp-bg: #F9F7F2;       /* å’Œç´™ç™½ */
            --jp-text: #3E3A39;     /* å¢¨é»‘ */
            --jp-accent: #8D936F;   /* æŠ¹èŒ¶ç¶  */
            --jp-sub: #9E9487;      /* æš–ç° */
            --jp-card: #FFFFFF;
            --jp-border: #E6E2DC;
        }

        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            background-color: var(--jp-bg); 
            color: var(--jp-text);
            padding-bottom: 100px; 
            line-height: 1.6;
        }

        h1, h2, h3, .serif {
            font-family: 'Zen Old Mincho', serif;
        }

        /* éš±è—æ»¾å‹•æ¢ */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* å¡ç‰‡æ¨£å¼ */
        .card-zen {
            background-color: var(--jp-card);
            border: 1px solid var(--jp-border);
            border-radius: 8px; /* è¼ƒå°çš„åœ“è§’ */
            box-shadow: 0 2px 5px rgba(0,0,0,0.03); /* æ¥µæ·¡é™°å½± */
            transition: all 0.3s ease;
        }
        .card-zen:active {
            background-color: #F2EFE9;
            transform: scale(0.99);
        }

        /* æ™‚é–“è»¸ç·šæ¢ */
        .timeline-line {
            position: absolute;
            left: 20px;
            top: 35px;
            bottom: -20px;
            width: 1px;
            background-color: var(--jp-border);
            z-index: 0;
        }
        .last-item .timeline-line { display: none; }

        /* å°èˆªæŒ‰éˆ• */
        .nav-icon-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #F4F4F4;
            color: var(--jp-sub);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        .nav-icon-btn:hover {
            background-color: var(--jp-accent);
            color: white;
        }

        /* Modal */
        .modal { transition: opacity 0.3s ease; }
        .modal.hidden { pointer-events: none; opacity: 0; }
        .modal.flex { pointer-events: auto; opacity: 1; }

        /* Map */
        #map { height: 40vh; width: 100%; border-bottom: 1px solid var(--jp-border); }
        
        /* é¸å–®æŒ‰éˆ•æ¿€æ´»ç‹€æ…‹ */
        .nav-active { color: var(--jp-accent); }
        .nav-active i { transform: scale(1.1); }
    </style>
</head>
<body>

    <header class="bg-[#F9F7F2]/95 backdrop-blur-md sticky top-0 z-50 border-b border-[#E6E2DC] px-6 py-4 shadow-sm">
        <div class="flex justify-between items-end">
            <div>
                <p id="header-date" class="text-xs font-bold tracking-widest text-[#9E9487] uppercase mb-1">2025/12/13 â€¢ SATURDAY</p>
                <h1 class="text-2xl font-bold text-[#3E3A39] serif">æ¾³é–€å…­äººè¡Œ</h1>
            </div>
            <div class="text-right">
                <div class="flex flex-col items-end">
                    <span id="header-weather-icon" class="text-xl text-[#8D936F]"><i class="fas fa-sun"></i></span>
                    <span id="header-temp" class="text-sm font-medium text-[#3E3A39]">18Â°C</span>
                </div>
            </div>
        </div>
        <div class="flex gap-2 mt-3 overflow-x-auto no-scrollbar">
            <span class="px-2 py-0.5 border border-[#8D936F] text-[#8D936F] text-[10px] rounded">ç´ é£Ÿå‹å–„</span>
            <span class="px-2 py-0.5 border border-[#9E9487] text-[#9E9487] text-[10px] rounded">åˆ†æµå®‰æ’</span>
        </div>
    </header>

    <main class="p-4 max-w-md mx-auto min-h-screen">
        
        <div id="view-day1" class="tab-view block">
            <div class="mb-6 mt-2 pl-2 border-l-4 border-[#8D936F]">
                <h2 class="text-xl font-bold text-[#3E3A39] serif">å…§æ¸¯é¢¨æƒ…èˆ‡è‘¡éŸ»</h2>
                <p class="text-xs text-[#9E9487]">Day 1 â€¢ å®¿ï¼šåå…­æµ¦ç´¢è²ç‰¹</p>
            </div>
            <div id="timeline-day1"></div>
        </div>

        <div id="view-day2" class="tab-view hidden">
            <div class="mb-6 mt-2 pl-2 border-l-4 border-[#8D936F]">
                <h2 class="text-xl font-bold text-[#3E3A39] serif">ç¾é£Ÿåˆ†æµèˆ‡å¥¢è¯</h2>
                <p class="text-xs text-[#9E9487]">Day 2 â€¢ å®¿ï¼šæ¾³é–€ç‘å‰</p>
            </div>
            <div id="timeline-day2"></div>
        </div>

        <div id="view-day3" class="tab-view hidden">
            <div class="mb-6 mt-2 pl-2 border-l-4 border-[#8D936F]">
                <h2 class="text-xl font-bold text-[#3E3A39] serif">è·¯ç’°æ…¢æ´»èˆ‡è¿”å°</h2>
                <p class="text-xs text-[#9E9487]">Day 3 â€¢ è¿”ç¨‹</p>
            </div>
            <div id="timeline-day3"></div>
        </div>

        <div id="view-illustration" class="tab-view hidden">
            <div class="mb-6 mt-2 pl-2 border-l-4 border-[#8D936F]">
                <h2 class="text-xl font-bold text-[#3E3A39] serif">è¡Œç¨‹æ‰‹ç¹ª & å®¢æˆ¿é¤é£²</h2>
            </div>
            
            <div class="card-zen p-2 mb-6">
                <img src="https://raw.githubusercontent.com/skywindy0727/skywindy0727.github.io/refs/heads/main/Gemini_Generated_Image_ffkb37ffkb37ffkb.png" alt="Map" class="w-full rounded h-auto object-cover">
                <p class="text-center text-xs text-[#9E9487] mt-2">Trip Highlights Illustration</p>
            </div>

            <div class="card-zen p-5">
                <h3 class="text-lg font-bold mb-4 serif border-b pb-2 border-[#E6E2DC]">ğŸ¨ ç‘å‰å®¢æˆ¿é¤é£²æ¨è–¦</h3>
                <p class="text-xs text-[#9E9487] mb-4">é ç®— 800 MOP å…§çµ„åˆ (å«æœå‹™è²»)</p>
                
                <div class="mb-4">
                    <span class="text-xs font-bold bg-[#3E3A39] text-white px-2 py-0.5 rounded mb-1 inline-block">ç¶“å…¸è‘·é£Ÿ</span>
                    <div class="flex justify-between text-sm mb-1">
                        <span>æµ·å—é›é£¯ (Hainanese Chicken Rice)</span>
                        <span class="font-mono">MOP 268</span>
                    </div>
                    <div class="flex justify-between text-sm mb-1">
                        <span>ç‘å‰æ¼¢å ¡ (The St. Regis Burger)</span>
                        <span class="font-mono">MOP 248</span>
                    </div>
                </div>

                <div class="mb-4">
                    <span class="text-xs font-bold bg-[#8D936F] text-white px-2 py-0.5 rounded mb-1 inline-block">ç²¾ç·»ç´ é£Ÿ</span>
                    <div class="flex justify-between text-sm mb-1">
                        <span>æ¾éœ²é‡èŒç‡‰é£¯ (Mushroom Risotto)</span>
                        <span class="font-mono">MOP 228</span>
                    </div>
                    <div class="flex justify-between text-sm mb-1">
                        <span>ç”°åœ’æ²™æ‹‰ (Garden Salad)</span>
                        <span class="font-mono">MOP 148</span>
                    </div>
                </div>

                <div class="mt-4 pt-3 border-t border-dashed border-[#E6E2DC] flex justify-between items-center">
                    <span class="text-xs text-[#9E9487]">ç¸½è¨ˆ (ä¸å«ç¨…)</span>
                    <span class="text-lg font-bold font-mono text-[#8D936F]">â‰ˆ MOP 892</span>
                </div>
                <p class="text-[10px] text-gray-400 mt-1">*åƒ¹æ ¼åƒ…ä¾›åƒè€ƒï¼Œä»¥ç¾å ´èœå–®ç‚ºæº–ã€‚å»ºè­°é¸æ“‡ 2-3 é“åˆ†äº«ã€‚</p>
            </div>
        </div>

        <div id="view-souvenir" class="tab-view hidden">
            <div class="mb-6 mt-2 pl-2 border-l-4 border-[#8D936F]">
                <h2 class="text-xl font-bold text-[#3E3A39] serif">æ¾³é–€å¿…è²·ä¼´æ‰‹ç¦®</h2>
            </div>
            <div id="souvenir-list" class="space-y-4">
                </div>
        </div>

        <div id="view-map" class="tab-view hidden">
            <div id="map" class="rounded-lg shadow-inner mb-4"></div>
            
            <div class="bg-white rounded-t-xl p-4 shadow-lg -mt-2 relative z-10">
                <h3 class="text-sm font-bold text-[#9E9487] uppercase mb-3 tracking-widest">è¡Œç¨‹åœ°é»æ¸…å–®</h3>
                <div id="map-location-list" class="space-y-2 max-h-[40vh] overflow-y-auto no-scrollbar pb-10">
                    </div>
            </div>
        </div>

    </main>

    <nav class="fixed bottom-0 left-0 right-0 bg-[#F9F7F2]/95 backdrop-blur-md border-t border-[#E6E2DC] py-2 px-2 flex justify-around items-center z-40 max-w-md mx-auto text-[#9E9487]">
        <button onclick="switchTab('day1')" class="nav-btn flex flex-col items-center p-2" data-target="day1">
            <i class="fas fa-archway text-lg mb-1"></i><span class="text-[9px]">Day 1</span>
        </button>
        <button onclick="switchTab('day2')" class="nav-btn flex flex-col items-center p-2" data-target="day2">
            <i class="fas fa-star text-lg mb-1"></i><span class="text-[9px]">Day 2</span>
        </button>
        <button onclick="switchTab('day3')" class="nav-btn flex flex-col items-center p-2" data-target="day3">
            <i class="fas fa-plane text-lg mb-1"></i><span class="text-[9px]">Day 3</span>
        </button>
        <button onclick="switchTab('illustration')" class="nav-btn flex flex-col items-center p-2" data-target="illustration">
            <i class="fas fa-utensils text-lg mb-1"></i><span class="text-[9px]">é¤é£²</span>
        </button>
        <button onclick="switchTab('souvenir')" class="nav-btn flex flex-col items-center p-2" data-target="souvenir">
            <i class="fas fa-gift text-lg mb-1"></i><span class="text-[9px]">ä¼´æ‰‹ç¦®</span>
        </button>
        <button onclick="switchTab('map')" class="nav-btn flex flex-col items-center p-2" data-target="map">
            <i class="fas fa-map-marked-alt text-lg mb-1"></i><span class="text-[9px]">åœ°åœ–</span>
        </button>
    </nav>

    <div id="info-modal" class="modal hidden fixed inset-0 bg-[#3E3A39]/60 z-[60] flex items-center justify-center p-4 backdrop-blur-sm" onclick="if(event.target === this) closeModal()">
        <div class="bg-[#F9F7F2] rounded-lg w-full max-w-sm overflow-hidden shadow-2xl relative">
            <button onclick="closeModal()" class="absolute top-3 right-3 w-8 h-8 bg-white/50 rounded-full flex items-center justify-center text-[#3E3A39] z-10"><i class="fas fa-times"></i></button>
            <div class="h-40 overflow-hidden">
                <img id="modal-image" src="" class="w-full h-full object-cover">
            </div>
            <div class="p-6">
                <span id="modal-tag" class="text-[10px] uppercase tracking-widest border border-[#8D936F] text-[#8D936F] px-2 py-0.5 rounded mb-2 inline-block">Tag</span>
                <h3 id="modal-title" class="text-xl font-bold serif mb-1 text-[#3E3A39]">Title</h3>
                <p id="modal-address" class="text-xs text-[#9E9487] mb-4"><i class="fas fa-map-pin mr-1"></i> Address</p>
                
                <div id="modal-highlight" class="hidden bg-[#E6E2DC]/30 p-3 rounded mb-4 text-sm border-l-2 border-[#8D936F]">
                    <div id="modal-highlight-content" class="text-[#3E3A39]"></div>
                </div>

                <div class="prose prose-sm text-[#3E3A39] leading-relaxed mb-4">
                    <p id="modal-desc"></p>
                </div>

                <div id="modal-veg" class="hidden mt-2 p-2 bg-[#8D936F]/10 rounded text-xs text-[#556B2F]">
                    <i class="fas fa-leaf mr-1"></i> <span id="modal-veg-content"></span>
                </div>
            </div>
            <div class="p-4 bg-white border-t border-[#E6E2DC]">
                <a id="modal-map-btn" href="#" target="_blank" class="block w-full bg-[#3E3A39] text-white text-center py-3 rounded hover:bg-[#2C2928] transition text-sm tracking-wide">
                    é–‹å•Ÿ Google Maps å°èˆª
                </a>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        // --- 1. è³‡æ–™åº« ---
        
        // å¤©æ°£æ¨¡æ“¬æ•¸æ“š
        const weatherData = {
            day1: { date: "2025/12/13", day: "SATURDAY", temp: "18Â°C", icon: "fa-sun", condition: "æ™´æœ—" },
            day2: { date: "2025/12/14", day: "SUNDAY", temp: "20Â°C", icon: "fa-cloud-sun", condition: "å¤šé›²" },
            day3: { date: "2025/12/15", day: "MONDAY", temp: "19Â°C", icon: "fa-wind", condition: "å¾®é¢¨" },
            default: { date: "TRIP INFO", day: "DEC 2025", temp: "--", icon: "fa-info-circle" }
        };

        const scheduleData = {
            day1: [
                { time: "10:00", title: "æŠµé”æ¾³é–€", location: "æ¾³é–€åœ‹éš›æ©Ÿå ´ (MFM)", desc: "NX631 æŠµé”ã€‚åˆ†ä¹˜2å°è¨ˆç¨‹è»Šå‰å¾€åå…­æµ¦ã€‚", icon: "fa-plane-arrival", link: "https://goo.gl/maps/macauairport", modal: { title: "NX631 æŠµé”", desc: "TPE âœˆï¸ MFMã€‚å‡ºé—œå¾Œè«‹åˆ†ä¹˜è¨ˆç¨‹è»Šã€‚", img: "https://placehold.co/600x400/8D936F/FFF?text=Airport" } },
                { time: "12:30", title: "é£¯åº— Check-in / å¯„æ”¾", location: "åå…­æµ¦ç´¢è²ç‰¹", desc: "è¾¦ç†æ‰‹çºŒæˆ–å…ˆå¯„æ”¾è¡Œæã€‚", icon: "fa-suitcase", link: "https://goo.gl/maps/sofitel", modal: { title: "åå…­æµ¦ç´¢è²ç‰¹", desc: "å…§æ¸¯å€äº”æ˜Ÿé…’åº—ï¼Œèåˆæ³•å¼èˆ‡ä¸­å¼é¢¨æƒ…ã€‚", highlight: "é å®šä»£è™Ÿï¼šPMZSBJQK", img: "https://placehold.co/600x400/E6E2DC/333?text=Sofitel" } },
                { time: "13:30", title: "åˆé¤ï¼šæ¨‚è»’è¯", location: "ç´¢è²ç‰¹ 18æ¨“", desc: "270åº¦æ±Ÿæ™¯ç²µèœï¼Œç’°å¢ƒèˆ’é©ã€‚", icon: "fa-utensils", link: "https://goo.gl/maps/sofitel", modal: { title: "æ¨‚è»’è¯ Le Chinois", desc: "ç²¾ç·»ç²µèœï¼Œäº¦æœ‰ç´ é£Ÿé»å¿ƒèˆ‡ç†±ç‚’ã€‚", veg: "ç´ é£Ÿå‹å–„", img: "https://placehold.co/600x400/F9F7F2/333?text=Le+Chinois" } },
                { time: "15:00", title: "æ¼«æ­¥å¤§ä¸‰å·´", location: "è­°äº‹äº­å‰åœ° â†’ æˆ€æ„›å··", desc: "æ­¥è¡Œç´„8åˆ†é˜ã€‚åƒè§€ç«ç‘°å ‚ã€å¤§ä¸‰å·´ã€‚", icon: "fa-walking", link: "https://goo.gl/maps/ruins", modal: { title: "æ­·å²åŸå€", desc: "æ¾³é–€åœ°æ¨™å·¡ç¦®ã€‚", img: "https://placehold.co/600x400/ddd/333?text=Ruins" } },
                { time: "17:00", title: "è·¨æµ·ç§»å‹•", location: "å‰å¾€è·¯æ°¹åŸå€", desc: "æ­è»Šå‰å¾€ JWè¬è±ª / ä¸Šè‘¡äº¬ã€‚", icon: "fa-taxi", link: "https://goo.gl/maps/galaxy", modal: { title: "ç§»å‹•", desc: "æº–å‚™å‰å¾€æ™šé¤åœ°é»ã€‚", img: "https://placehold.co/600x400/ccc/333?text=Taxi" } },
                { time: "19:00", title: "æ™šé¤ï¼šåå»šéƒ½åŒ¯/è‡ªåŠ©å±±", location: "JWè¬è±ª / ä¸Šè‘¡äº¬", desc: "åˆ†æµç”¨é¤ã€‚é¤å¾Œè¿”å›ç´¢è²ç‰¹ã€‚", icon: "fa-users", link: "https://goo.gl/maps/jwmarriott", modal: { title: "æ™šé¤åˆ†æµ", desc: "2äººJWè¬è±ªï¼Œ4äººè‡ªåŠ©å±±ã€‚", highlight: "å·²é è¨‚", img: "https://placehold.co/600x400/333/FFF?text=Dinner" } }
            ],
            day2: [
                { time: "10:00", title: "Check-out & ç§»å‹•", location: "å‰å¾€ç‘å‰é…’åº—", desc: "é€€æˆ¿ï¼Œæ­è»Šè‡³ç‘å‰å¯„æ”¾è¡Œæã€‚", icon: "fa-sign-out-alt", link: "https://goo.gl/maps/stregis", modal: { title: "ç§»å‹•æ—¥", desc: "å‰å¾€è·¯æ°¹é‡‘å…‰å¤§é“ã€‚", img: "https://placehold.co/600x400/8D936F/FFF?text=Move" } },
                { time: "11:30", title: "åˆé¤ï¼šLa Famiglia", location: "æ°¹ä»”å®˜ä¹Ÿè¡—", desc: "è‘¡æ„æ–™ç†ã€‚é¤å¾Œé€›è¡—ã€‚", icon: "fa-utensils", link: "https://goo.gl/maps/lafamiglia", modal: { title: "La Famiglia", desc: "æº«é¦¨è‘¡åœ‹èœï¼Œç´ é£Ÿå¯åšç‡‰é£¯ã€‚", veg: "å¯å®¢è£½ç´ é£Ÿ", img: "https://placehold.co/600x400/eee/333?text=La+Famiglia" } },
                { time: "14:00", title: "âš ï¸ åˆ†æµé€æ©Ÿ", location: "å‰å¾€æ©Ÿå ´ / ç‘å‰", desc: "1äººè¿”å°ï¼Œ5äººæ­¥è¡Œå›ç‘å‰ã€‚", icon: "fa-user-clock", link: "https://goo.gl/maps/macauairport", modal: { title: "åˆ†æµæ™‚åˆ»", desc: "è¿”å°è€…éœ€æ–¼15:00å‰é›¢é–‹å®˜ä¹Ÿè¡—ã€‚", highlight: "NX618 17:35 èµ·é£›", img: "https://placehold.co/600x400/999/FFF?text=Airport" } },
                { time: "15:00", title: "ç‘å‰ Check-in", location: "æ¾³é–€ç‘å‰é…’åº—", desc: "é«”é©—ç®¡å®¶æœå‹™ï¼Œåƒè§€å€«æ•¦äººã€‚", icon: "fa-key", link: "https://goo.gl/maps/stregis", modal: { title: "å…¥ä½ç‘å‰", desc: "äº«å—å¥¢è¯ç®¡å®¶æœå‹™ã€‚", highlight: "ä»£è™Ÿï¼š81555809", img: "https://placehold.co/600x400/222/FFF?text=St.Regis" } },
                { time: "18:30", title: "æ™šé¤ï¼šé›…èˆ/å®¢æˆ¿æœå‹™", location: "ç‘å‰ 1æ¨“/å®¢æˆ¿å…§", desc: "Fine Dining å¥—é¤/å–®é»èœè‰²ã€‚", icon: "fa-wine-glass", link: "https://goo.gl/maps/themanor", modal: { title: "é›…èˆ The Manor", desc: "é ‚ç´šè¥¿é¤ã€‚", veg: "éœ€æå‰å‘ŠçŸ¥ç´ é£Ÿ", img: "https://placehold.co/600x400/444/FFF?text=The+Manor" } }
            ],
            day3: [
                { time: "09:00", title: "æ—©é¤", location: "ç‘å‰é›…èˆ", desc: "åŠè‡ªåŠ©å¼æ—©é¤ã€‚", icon: "fa-coffee", link: "https://goo.gl/maps/themanor", modal: { title: "é›…èˆæ—©é¤", desc: "å¿…é»é¾è¦è›‹ã€‚", img: "https://placehold.co/600x400/555/FFF?text=Breakfast" } },
                { time: "11:00", title: "è·¯ç’°æ…¢æ´»", location: "è·¯ç’°æ¼æ‘", desc: "è–æ–¹æ¿Ÿå„å ‚ã€å®‰å¾·é­¯è›‹å¡”ã€‚", icon: "fa-camera", link: "https://goo.gl/maps/coloane", modal: { title: "è·¯ç’°æ¼æ‘", desc: "æ‚ é–’çš„å°æ¼æ‘é¢¨æƒ…ã€‚", img: "https://placehold.co/600x400/777/FFF?text=Coloane" } },
                { time: "12:30", title: "åˆé¤ï¼šé›…æ†©èŠ±åœ’", location: "è·¯ç’°å¤§æ¨¹ä¸‹", desc: "æˆ¶å¤–ç”¨é¤æ°›åœä½³ã€‚", icon: "fa-tree", link: "https://goo.gl/maps/ngatim", modal: { title: "é›…æ†©èŠ±åœ’", desc: "æ¨è–¦è¥¿æ´‹çƒšèœã€ç‚’é£¯ã€‚", veg: "æœ‰å¤šæ¬¾ç´ èœ", img: "https://placehold.co/600x400/888/FFF?text=Nga+Tim" } },
                { time: "15:30", title: "å‰å¾€æ©Ÿå ´", location: "æ¾³é–€åœ‹éš›æ©Ÿå ´", desc: "ç‘å‰å‡ºç™¼ç´„10åˆ†é˜ã€‚", icon: "fa-taxi", link: "https://goo.gl/maps/macauairport", modal: { title: "è¿”ç¨‹", desc: "NX618 17:35 èµ·é£›ã€‚", img: "https://placehold.co/600x400/000/FFF?text=Bye" } }
            ]
        };

        const souvenirData = [
            { name: "æä»é¤…", brand: "æœ€é¦™é¤…å®¶ (ç‚­ç‡’)", loc: "å¤œå‘£è¡— (éœ€æ’éšŠ)", desc: "æ‰‹å·¥ç‚­ç‡’ï¼Œå£æ„Ÿé…¥è„†ï¼Œå¸¶æœ‰ç‚­é¦™å‘³ã€‚", link: "https://goo.gl/maps/choiheong" },
            { name: "è‘¡å¼è›‹å¡”", brand: "å®‰å¾·é­¯é¤…åº—", loc: "è·¯ç’°ç¸½åº— / å¨å°¼æ–¯äºº", desc: "æ¾³é–€å¿…åƒï¼Œå¤–çš®é…¥è„†å¥¶é¦™æ¿ƒéƒã€‚", link: "https://goo.gl/maps/lordstow" },
            { name: "èŠ±ç”Ÿç³–", brand: "é‰…è¨˜æ‰‹ä¿¡", loc: "å„å¤§åˆ†åº—", desc: "é¦™è„†ä¸é»ç‰™ï¼Œè€å°‘å’¸å®œã€‚", link: "https://goo.gl/maps/koikei" },
            { name: "è‘¡åœ‹è€äººç‰Œæ²™ä¸é­š", brand: "Loja das Conservas", loc: "è­°äº‹äº­å‰åœ°é™„è¿‘", desc: "è‰²å½©ç¹½ç´›çš„ç½é ­ï¼Œé©åˆé€ç¦®ã€‚", link: "https://goo.gl/maps/sardine" },
            { name: "è›‹æ²", brand: "è‹±è¨˜é¤…å®¶", loc: "å¤§ä¸‰å·´è¡—", desc: "å‚³çµ±æ‰‹ä¿¡ï¼ŒåŒ…è£ç²¾ç¾ã€‚", link: "https://goo.gl/maps/yengkee" }
        ];

        // åœ°åœ–åº§æ¨™ (Google Maps é€£å‹•ç”¨)
        const mapLocations = [
            { lat: 22.1965, lng: 113.5363, title: "D1 åå…­æµ¦ç´¢è²ç‰¹", day: "Day 1" },
            { lat: 22.1975, lng: 113.5407, title: "D1 å¤§ä¸‰å·´ç‰ŒåŠ", day: "Day 1" },
            { lat: 22.1492, lng: 113.5539, title: "D1 JWè¬è±ªé…’åº—", day: "Day 1" },
            { lat: 22.1465, lng: 113.5562, title: "D2 æ¾³é–€ç‘å‰é…’åº—", day: "Day 2" },
            { lat: 22.1539, lng: 113.5566, title: "D2 La Famiglia (å®˜ä¹Ÿè¡—)", day: "Day 2" },
            { lat: 22.1186, lng: 113.5517, title: "D3 è·¯ç’°è–æ–¹æ¿Ÿå„å ‚", day: "Day 3" },
            { lat: 22.1583, lng: 113.5657, title: "D3 æ¾³é–€åœ‹éš›æ©Ÿå ´", day: "Day 3" }
        ];

        // --- 2. æ¸²æŸ“é‚è¼¯ ---

        function renderTimeline(dayId, data) {
            const container = document.getElementById(`timeline-${dayId}`);
            let html = '';
            
            data.forEach((item, index) => {
                const isLast = index === data.length - 1;
                const modalStr = encodeURIComponent(JSON.stringify(item.modal));

                html += `
                    <div class="flex relative mb-6 ${isLast ? 'last-item' : ''}">
                        <div class="w-12 text-right pr-2 pt-1 flex-shrink-0 z-10">
                            <span class="text-xs font-bold text-[#9E9487] font-mono">${item.time}</span>
                        </div>
                        
                        <div class="relative flex flex-col items-center mr-3 z-10">
                            <div class="w-8 h-8 rounded-full bg-white border border-[#E6E2DC] flex items-center justify-center text-[#8D936F] z-20 shadow-sm">
                                <i class="fas ${item.icon} text-xs"></i>
                            </div>
                            <div class="timeline-line"></div>
                        </div>

                        <div class="card-zen p-3 flex-grow flex justify-between items-center cursor-pointer" onclick="openModal('${modalStr}')">
                            <div class="flex-grow pr-2">
                                <h3 class="font-bold text-[#3E3A39] text-sm mb-1">${item.title}</h3>
                                <div class="text-xs font-medium text-[#8D936F] mb-1">
                                    <i class="fas fa-map-marker-alt mr-1"></i>${item.location}
                                </div>
                                <p class="text-[10px] text-[#9E9487]">${item.desc}</p>
                            </div>
                            
                            <a href="${item.link}" target="_blank" onclick="event.stopPropagation()" class="nav-icon-btn flex-shrink-0">
                                <i class="fas fa-location-arrow text-sm"></i>
                            </a>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        function renderSouvenirs() {
            const container = document.getElementById('souvenir-list');
            let html = '';
            souvenirData.forEach(item => {
                html += `
                <div class="card-zen p-4 flex justify-between items-start">
                    <div>
                        <h3 class="font-bold text-[#3E3A39] text-base">${item.name}</h3>
                        <p class="text-xs text-[#8D936F] font-bold mt-1">æ¨è–¦ï¼š${item.brand}</p>
                        <p class="text-xs text-[#9E9487] mt-1"><i class="fas fa-store mr-1"></i>${item.loc}</p>
                        <p class="text-[10px] text-gray-400 mt-2">${item.desc}</p>
                    </div>
                    <a href="${item.link}" target="_blank" class="nav-icon-btn">
                        <i class="fas fa-location-arrow"></i>
                    </a>
                </div>`;
            });
            container.innerHTML = html;
        }

        function renderMapList() {
            const container = document.getElementById('map-location-list');
            let html = '';
            mapLocations.forEach((loc, index) => {
                html += `
                <div class="flex items-center p-3 border-b border-[#F9F7F2] hover:bg-[#F9F7F2] cursor-pointer transition" onclick="panMap(${loc.lat}, ${loc.lng})">
                    <span class="text-xs font-bold text-[#8D936F] w-12">${loc.day}</span>
                    <span class="text-sm text-[#3E3A39] flex-grow">${loc.title}</span>
                    <i class="fas fa-chevron-right text-xs text-[#E6E2DC]"></i>
                </div>`;
            });
            container.innerHTML = html;
        }

        // --- 3. æ ¸å¿ƒåŠŸèƒ½ ---

        let map;

        document.addEventListener("DOMContentLoaded", () => {
            renderTimeline('day1', scheduleData.day1);
            renderTimeline('day2', scheduleData.day2);
            renderTimeline('day3', scheduleData.day3);
            renderSouvenirs();
            renderMapList();
            
            // åˆå§‹åŒ– Header
            updateHeader('day1');
        });

        function switchTab(targetId) {
            // åˆ‡æ› View
            document.querySelectorAll('.tab-view').forEach(el => el.classList.add('hidden'));
            document.getElementById(`view-${targetId}`).classList.remove('hidden');
            
            // æ²å‹•ç½®é ‚
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // æ›´æ–° Navbar ç‹€æ…‹
            document.querySelectorAll('.nav-btn').forEach(btn => {
                if(btn.dataset.target === targetId) {
                    btn.classList.add('nav-active');
                } else {
                    btn.classList.remove('nav-active');
                }
            });

            // æ›´æ–° Header è³‡è¨Š
            updateHeader(targetId);

            // è‹¥åˆ‡æ›è‡³åœ°åœ–ï¼Œåˆå§‹åŒ–åœ°åœ–
            if (targetId === 'map') {
                setTimeout(initMap, 200);
            }
        }

        function updateHeader(tabId) {
            const data = weatherData[tabId] || weatherData.default;
            document.getElementById('header-date').innerText = `${data.date} â€¢ ${data.day}`;
            document.getElementById('header-temp').innerText = data.temp;
            document.getElementById('header-weather-icon').innerHTML = `<i class="fas ${data.icon}"></i>`;
        }

        function initMap() {
            if (map) return;
            // æ¾³é–€ä¸­å¿ƒ
            map = L.map('map').setView([22.16, 113.55], 12);
            
            // ä½¿ç”¨ Google Maps åœ–è³‡ (Standard Road Map)
            L.tileLayer('https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {
                attribution: 'Map data Â© Google',
                maxZoom: 20
            }).addTo(map);

            // æ¨™è¨˜
            mapLocations.forEach(loc => {
                L.marker([loc.lat, loc.lng]).addTo(map)
                 .bindPopup(`<b style="color:#3E3A39">${loc.title}</b>`);
            });
        }

        function panMap(lat, lng) {
            if(!map) return;
            map.flyTo([lat, lng], 15, { duration: 1.5 });
        }

        // Modal Controls
        function openModal(dataStr) {
            const data = JSON.parse(decodeURIComponent(dataStr));
            document.getElementById('modal-title').innerText = data.title;
            document.getElementById('modal-tag').innerText = data.tag || "INFO";
            document.getElementById('modal-address').innerHTML = `<i class="fas fa-map-pin mr-1"></i> ${data.desc}`; // Reuse desc for subtitle
            document.getElementById('modal-desc').innerHTML = data.desc;
            document.getElementById('modal-image').src = data.img;
            
            const highlightEl = document.getElementById('modal-highlight');
            if(data.highlight) { highlightEl.classList.remove('hidden'); document.getElementById('modal-highlight-content').innerText = data.highlight; } else { highlightEl.classList.add('hidden'); }

            const vegEl = document.getElementById('modal-veg');
            if(data.veg) { vegEl.classList.remove('hidden'); document.getElementById('modal-veg-content').innerText = data.veg; } else { vegEl.classList.add('hidden'); }

            document.getElementById('info-modal').classList.remove('hidden');
            document.getElementById('info-modal').classList.add('flex');
        }

        function closeModal() { document.getElementById('info-modal').classList.add('hidden'); document.getElementById('info-modal').classList.remove('flex'); }

    </script>
</body>
</html>
